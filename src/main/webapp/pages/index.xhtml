<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions">

<h:head>
	<h:outputStylesheet name="grid.css" library="css" />
	<h:outputStylesheet name="ext_960gs.css" library="css" />
	<h:outputStylesheet name="styleForPage.css" library="css" />
	<!-- 	<h:outputStylesheet name="bootstrap.css" library="css" /> -->
	<!-- 	<h:outputStylesheet name="layout.css" library="css" /> -->
	<h:outputScript name="utilsCommon.js" library="javascript" />

	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<title>DDUM - Dinheiro Direto nas Unidades Municipais</title>

	<script type="text/javascript">
		function logoutFunction() {
			logoutUser();
		}
		
		function carregarPagina(){
			setTimeout("window.location.reload();", 100);
		}
		
		function carregarIndex(){
			carregarMenuController();
		}
		
	</script>
</h:head>

<h:body style="font-size: 12px" onload="carregarIndex()">
	<pe:layout fullPage="true" id="layout">

		<!-- 		<p:layoutUnit id="layoutUnitNorth" position="north" header="DDUM" /> -->
		<pe:layoutPane position="north" size="75">
			<ui:include src="/sections/header.xhtml" />
		</pe:layoutPane>

		<pe:layoutPane id="layoutUnitWest" position="west" size="200"
			header="Menu Principal">

			<h:form id="form" prependId="false">
			<p:remoteCommand name="carregarMenuController" actionListener="#{mainMenu.index}" process="@this"/>

				<p:panelMenu id="panelMenu" style="width: 100%; ">
					<!-- 					<p:menubar id="panelMenu" style="width: 100%; "> -->
					<p:submenu id="parametros" label="Parametros do Sistema"
						rendered="true">
						<p:menuitem id="parametroRepasse" value="Parametro de Repasse" onclick="carregarPagina();"
							styleClass="#{mainMenu.numIndex == 2 ? 'selectedMenu' : null}"
							update=":centerContentPanel :form:panelMenu"
							actionListener="#{parametroRepasseController.init}"
							action="#{mainMenu.parametroRepasse}" icon="ui-icon-bookmark"
							disabled="#{loginController.principalRole eq 'ADMIN' ? false : loginController.principalRole eq 'AUDITOR' ? false : true}" />
						<p:menuitem id="feriado" value="Feriado" onclick="carregarPagina();"
							styleClass="#{mainMenu.numIndex == 11 ? 'selectedMenu' : null}"
							update=":centerContentPanel :form:panelMenu"
							actionListener="#{feriadoController.limparDados}"
							action="#{mainMenu.feriado}" icon="ui-icon-bookmark"
							disabled="#{loginController.principalRole eq 'ADMIN' ? false : true}" />

					</p:submenu>
					<p:submenu label="Cadastros Básicos" rendered="true"
						id="menuCadastro">
						<!-- 						<p:menuitem id="parametroModulo" value="Parametro do Módulo" -->
						<!-- 							styleClass="#{mainMenu.numIndex == 1 ? 'selectedMenu' : null}" -->
						<!-- 							update=":centerContentPanel :form:panelMenu" -->
						<!-- 							actionListener="#{parametroModuloController.init}" -->
						<!-- 							action="#{mainMenu.parametroModulo}" icon="ui-icon-bookmark" -->
						<!-- 							disabled="#{loginController.principalRole eq 'ADMIN' ? false : true}"> -->
						<!-- 						</p:menuitem> -->
						<p:menuitem id="responsavel" value="Responsável" onclick="carregarPagina();"
							styleClass="#{mainMenu.numIndex == 3 ? 'selectedMenu' : null}"
							update=":centerContentPanel :form:panelMenu"
							action="#{mainMenu.responsavel}" icon="ui-icon-person"
							actionListener="#{responsavelController.limparDados}"
							disabled="#{loginController.principalRole eq 'RESPONSÁVEL' ? true : false}">
						</p:menuitem>

						<p:menuitem id="unidade" value="Unidade Física" onclick="carregarPagina();"
							styleClass="#{mainMenu.numIndex == 4 ? 'selectedMenu' : null}"
							update=":centerContentPanel :form:panelMenu"
							actionListener="#{unidadeController.limparDados}"
							action="#{mainMenu.unidade}" icon="ui-icon-home"
							disabled="#{loginController.principalRole eq 'RESPONSÁVEL' ? true : false}" />
						<p:menuitem id="user" value="Usuário" onclick="carregarPagina();"
							styleClass="#{mainMenu.numIndex == 5 ? 'selectedMenu' : null}"
							update=":centerContentPanel :form:panelMenu"
							action="#{mainMenu.usuario}" icon="ui-icon-person"
							actionListener="#{userController.limparDados}" />
					</p:submenu>
					<p:submenu label="Empenho" rendered="true">
						<p:menuitem id="repasse" value="Gerar Empenho"
							icon="ui-icon-calculator"
							update=":centerContentPanel :form:panelMenu"
							action="#{mainMenu.gerarRepasse}"
							styleClass="#{mainMenu.numIndex == 6 ? 'selectedMenu' : null}"
							disabled="#{loginController.principalRole eq 'GESTOR' ? false : loginController.principalRole eq 'ADMIN' ? false : true}"
							actionListener="#{repasseController.limparRelatorio}" onclick="PF('repasseBlockUI').show()" oncomplete="PF('repasseBlockUI').hide()">
							
						</p:menuitem>
					</p:submenu>
					<p:submenu label="Prestação de Conta" rendered="true">
						<p:menuitem id="prestacao" value="Prestação de Contas"
							icon="ui-icon-note" update=":centerContentPanel :form:panelMenu"
							action="#{mainMenu.prestacaoConta}"
							actionListener="#{prestacaoContaController.carregarDados(true)}"
							styleClass="#{mainMenu.numIndex == 7 ? 'selectedMenu' : null}"
							disabled="#{loginController.principalRole eq 'RESPONSÁVEL' ? false : loginController.principalRole eq 'ADMIN' ? false : true}"
							onclick="PF('prestacaoBlockUI').show()" oncomplete="PF('prestacaoBlockUI').hide()">
							
						</p:menuitem>
					</p:submenu>
					<p:submenu label="Auditoria" rendered="true">
						<p:menuitem id="auditoria" value="Auditoria" icon="ui-icon-note"
							update=":centerContentPanel :form:panelMenu"
							action="#{mainMenu.auditoria}"
							actionListener="#{auditoriaController.filtrarDados()}"
							styleClass="#{mainMenu.numIndex == 12 ? 'selectedMenu' : null}"
							disabled="#{loginController.principalRole eq 'AUDITOR' ? false : loginController.principalRole eq 'ADMIN' ? false : true}"
							onclick="PF('auditoriaBlockUI').show()" oncomplete="PF('auditoriaBlockUI').hide()">
						</p:menuitem>
					</p:submenu>
					<p:submenu label="Relatórios" rendered="true">
						<p:menuitem id="report" value="Termo Compromisso"
							styleClass="#{mainMenu.numIndex == 8 ? 'selectedMenu' : null}"
							update=":centerContentPanel :form:panelMenu"
							action="#{mainMenu.report}" icon="ui-icon-print"
							actionListener="#{termoCompromissoReportController.limparRelatorio}"
							onclick="PF('reportBlockUI').show()" oncomplete="PF('reportBlockUI').hide()"/>
						<p:menuitem id="guiaEmpenhoReport" value="Demonst. Empenho"
							styleClass="#{mainMenu.numIndex == 13 ? 'selectedMenu' : null}"
							update=":centerContentPanel :form:panelMenu"
							action="#{mainMenu.guiaEmpenhoReport}" icon="ui-icon-print"
							actionListener="#{guiaEmpenhoReportController.limparRelatorio}"
							onclick="PF('reportBlockUI').show()" oncomplete="PF('reportBlockUI').hide()"/>
						<p:menuitem id="legislacaoReport" value="Legislação"
							styleClass="#{mainMenu.numIndex == 9 ? 'selectedMenu' : null}"
							update=":centerContentPanel :form:panelMenu"
							action="#{mainMenu.legislacaoReport}" icon="ui-icon-print"
							onclick="PF('reportBlockUI').show()" oncomplete="PF('reportBlockUI').hide()"/>
						<p:menuitem id="pesquisaPrecoReport" value="Consoli. Pesq. Preços"
							styleClass="#{mainMenu.numIndex == 10 ? 'selectedMenu' : null}"
							update=":centerContentPanel :form:panelMenu"
							action="#{mainMenu.pesquisaPrecoReport}" icon="ui-icon-print"
							onclick="PF('reportBlockUI').show()" oncomplete="PF('reportBlockUI').hide()"/>
					</p:submenu>
					<!-- 					</p:menubar> -->
				</p:panelMenu>

				<p:remoteCommand name="logoutUser"
					actionListener="#{loginController.logout(false)}" process="@this" />
					
					<!-- Block para os menus de Empenho e Prestação de Contas -->
					<p:blockUI block=":#{p:component('layoutUnitCenter')}"
								trigger=":form:repasse" widgetVar="repasseBlockUI">
								<h:outputLabel value="#{wd['blockui.loading.text']}" />
								<br />
								<h:graphicImage library="images"
									name="#{wd['blockui.loading.img']}" />
							</p:blockUI>
							
							<p:blockUI block=":#{p:component('layoutUnitCenter')}"
								trigger=":form:prestacao" widgetVar="prestacaoBlockUI">
								<h:outputLabel value="#{wd['blockui.loading.text']}" />
								<br />
								<h:graphicImage library="images"
									name="#{wd['blockui.loading.img']}" />
							</p:blockUI>
							<p:blockUI block=":#{p:component('layoutUnitCenter')}"
								trigger=":form:auditoria" widgetVar="auditoriaBlockUI">
								<h:outputLabel value="#{wd['blockui.loading.text']}" />
								<br />
								<h:graphicImage library="images"
									name="#{wd['blockui.loading.img']}" />
							</p:blockUI>
							
							<p:blockUI block=":#{p:component('layoutUnitCenter')}"
								trigger="" widgetVar="reportBlockUI">
								<h:outputLabel value="#{wd['blockui.loading.text']}" />
								<br />
								<h:graphicImage library="images"
									name="#{wd['blockui.loading.img']}" />
							</p:blockUI>
			</h:form>
		</pe:layoutPane>

		<pe:layoutPane id="layoutUnitCenter" position="center">
			<h:panelGroup id="centerContentPanel">
				<ui:include src="#{mainMenu.index}" />
			</h:panelGroup>
		</pe:layoutPane>

	</pe:layout>
	<!-- 900000 -->
	<p:idleMonitor timeout="600000">
		<p:ajax event="idle" listener="#{idleViewExpired.idleExpired}" />
	</p:idleMonitor>

	<p:dialog header="Expirou! " resizable="false" closable="false"
		widgetVar="idleDialog" modal="true" width="300" height="110"
		onShow="logoutFunction()">
		<div style="text-align: center;">
			<h:outputText value="Sua Sessão Expirou!" />
		</div>
		<br />
		<br />
		<br />
		<div style="text-align: center;">
			<!-- 			<p:commandButton styleClass="logout" alt="Logar Novamente" -->
			<!-- 				value="Logar Novamente" actionListener="#{loginController.logout}"/> -->
			<a href="#{request.contextPath}/login.xhtml">Clique Aqui para
				Logar Novamente</a>
		</div>
	</p:dialog>
</h:body>
</html>
